/*! mentDoc.js v0.4.0 23-05-2013 MIT LICENSE */
var mentDoc=function(){function t(t,e){this.el=t,this.parent=e||null,this.attrs={},this.children=[],this.data=e?o(e.data):{},this.el.style.textDecoration="none",this.refreshAttrs(),this.updateChildren()}function e(t,i,o){var c;if(t&&i)if(o=o||t,r(t))for(c in t)"prototype"!=c&&"length"!=c&&"name"!=c&&t.hasOwnProperty(c)&&i.call(o,t[c],c);else if(t.forEach&&t.forEach!==e)t.forEach(i,o);else if(n(t)||t.hasOwnProperty("length"))for(c=0;t.length>c;c++)i.call(o,t[c],c);else for(c in t)t.hasOwnProperty(c)&&i.call(o,t[c],c);return t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){return"object"==typeof t&&null!==t}function r(t){return"function"==typeof t}function o(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e}var c,a={},u=1;return t.isCommandEl=function(t){return t.nodeType===u&&("U"===t.nodeName||null!==t.getAttribute("you"))},t.prototype={constructor:t,isRoot:!1,refreshAttrs:function(){return this.attrs={},e(this.el.attributes,function(t){if(t.specified){var e=t.name,n=this.el.getAttribute(e,3),i=c.normalizeAttr(e);this.attrs[i]=n,a[i]&&r(a[i].encounter)&&a[i].encounter(this.el,n,this)}},this),this},updateChildren:function(){return this.children=[],this._loopThroughEl(this.el.childNodes),this},_loopThroughEl:function(n){return e(n,function(e){if(t.isCommandEl(e)){var n=new t(e,this);this.children.push(n),n.updateChildren()}else e.nodeType===u&&this._loopThroughEl(e.childNodes)},this),this},execute:function(){return e(this._sortedDirectives(),function(t){r(a[t].execute)&&a[t].execute(this.el,this.attrs[t],this)},this),this.executeChildren(),this},executeChildren:function(){return e(this.children,function(t){t.execute()}),this},_sortedDirectives:function(){var t=[];return e(this.attrs,function(e,n){a[n]&&t.push(n)},this),t.sort(function(t,e){return a[t].priority-a[e].priority})},getElContent:function(){return this.el.innerHTML}},c={Command:t,compile:function(e){var n;n=document.createElement("u"),n.innerHTML=e;var i=new t(n);return i.isRoot=!0,i},priorityAlias:{high:10,medium:20,low:30,"default":30},regDirectives:a,addDirective:function(t,e){if("function"==typeof e&&(e={execute:e}),e.priority?"string"==typeof e.priority&&(e.priority=this.priorityAlias[e.priority]):e.priority=this.priorityAlias["default"],isNaN(e.priority))throw"Unknown priority given for directive `"+t+"` : "+e.priority;a[t]=e},normalizeAttr:function(){function t(t){return t.replace(n,function(t,e,n,i){return i?n.toUpperCase():n}).replace(i,"Moz$1")}var e=/^(x[\:\-_]|data[\:\-_])/i,n=/([\:\-\_]+(.))/g,i=/^moz([A-Z])/;return function(n){return t(n.replace(e,""))}}(),forEach:e,isArray:n,isObject:i,isFn:r,makeInherit:o}}();mentDoc.addDirective("inEl",function(t,e,n){n.data.inEl=e}),mentDoc.addDirective("appendTo",function(t,e,n){$(e,n.data.inEl).append(n.getElContent())}),mentDoc.addDirective("empty",{priority:"medium",execute:function(t,e,n){$(e,n.data.inEl).empty()}}),mentDoc.addDirective("remove",function(t,e,n){$(e,n.data.inEl).remove()}),mentDoc.markdown={convertHtml:function(t){var e=Markdown.getSanitizingConverter();Markdown.Extra.init(e,{extensions:"all",highlighter:"prettify"});var n=t.match(/(\t| )+\^\^\^/g);if(n){var i=n[0].length-3;lines=t.split(/\n/g);for(var r=0;lines.length>r;r++)lines[r]=lines[r].substring(i),"^^^"===lines[r]&&(lines[r]="");t=lines.join("\n")}return e.makeHtml(t)}},mentDoc.addDirective("markdown",{priority:"high",encounter:function(t,e,n){n.getElContent=function(){return n.data.hasOwnProperty("compiledMarkdown")||(n.data.compiledMarkdown=mentDoc.markdown.convertHtml(n.getElContent())),n.data.compiledMarkdown}}}),"undefined"!=typeof module&&module.exports&&(module.exports.mentDoc=mentDoc);